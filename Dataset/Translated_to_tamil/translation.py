# -*- coding: utf-8 -*-
"""Translation

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/123P4sKvOOuSVRk60QDixS0L8MFPU-Z9l
"""

from deep_translator import GoogleTranslator
import time

def batch_translate(sentences, protected_words, batch_size=10):
    results = []

    for i in range(0, len(sentences), batch_size):
        batch = sentences[i:i+batch_size]

        masked_batch = []
        placeholders_list = []

        # mask protected words
        for sentence in batch:
            masked, placeholders = mask_protected_words(sentence, protected_words)
            masked_batch.append(masked)
            placeholders_list.append(placeholders)

        # translate whole batch together
        translated_batch = GoogleTranslator(source='auto', target='ta').translate_batch(masked_batch)

        # unmask protected words
        for translated, placeholders in zip(translated_batch, placeholders_list):
            results.append(unmask_protected_words(translated, placeholders))

        time.sleep(1)  # prevent rate-limit

    return results


# -------------------------------------------------------------
# RUN BATCH TRANSLATION FOR ALL COLUMNS
# -------------------------------------------------------------
for col in df.columns:
    print(f"Translating column: {col}")
    df[col] = batch_translate(df[col].astype(str).tolist(), protected_words)

print("âœ” FAST translation completed!")

df.to_csv("FAQ-OF-AI_translated_tamil.csv", index=False)

from google.colab import files
files.download("FAQ-OF-AI_translated_tamil.csv")